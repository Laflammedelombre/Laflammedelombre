<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laisser un Avis - La Flamme de l'Ombre</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Styles de base de votre site (navigation et fond) */
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            text-align: center;
            min-height: 100vh;
        }
        nav ul {
            list-style-type: none; padding: 0; margin: 20px 0; display: flex; flex-wrap: wrap; justify-content: center;
        }
        nav ul li {
            margin: 10px 15px;
        }
        nav ul li a {
            color: white; text-decoration: none; font-weight: bold;
        }
        nav ul li a:hover {
            text-decoration: underline;
        }
        
        /* Styles spécifiques au formulaire */
        .form-container {
            max-width: 600px;
            margin: 40px auto;
            padding: 30px;
            background-color: #1a1a1a;
            border-radius: 10px;
            text-align: left;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"], input[type="email"], textarea {
            width: 95%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #444;
            background-color: #333;
            color: white;
            font-size: 1em;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        button {
            background-color: #555;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            margin-top: 20px;
            width: 100%;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #777;
        }
        
        /* Système d'étoiles (Notation) */
        .rating {
            font-size: 2em;
            unicode-bidi: bidi-override;
            direction: rtl;
            text-align: center;
            margin: 10px 0 20px;
        }
        .rating > input {
            display: none;
        }
        .rating > label:before {
            content: '★';
            color: #444; /* Couleur des étoiles non cochées */
            padding: 5px;
            cursor: pointer;
        }
        .rating > input:checked ~ label:before,
        .rating > input:checked ~ label:before,
        .rating > label:hover:before,
        .rating > label:hover ~ label:before {
            color: gold; /* Couleur des étoiles cochées ou survolées */
        }
        #response-message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">Accueil</a></li>
            <li><a href="about.html">À propos</a></li>
            <li><a href="form.html">Formulaire de Question (Gratuit)</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="avis.html">Avis</a></li>
            <li><a href="carte.html">Carte du jour</a></li>
        </ul>
    </nav>

    <div class="form-container">
        <h1>Laisser votre Avis</h1>
        <form id="avisForm">
            <label for="Prénom">Votre Prénom :</label>
            <input type="text" id="Prénom" name="Prénom" required>

            <label for="Email">Votre Email :</label>
            <input type="email" id="Email" name="Email" required>

            <label>Votre Note :</label>
            <div class="rating">
                <input type="radio" id="star5" name="Note" value="5" required /><label for="star5" title="5 étoiles"></label>
                <input type="radio" id="star4" name="Note" value="4" /><label for="star4" title="4 étoiles"></label>
                <input type="radio" id="star3" name="Note" value="3" /><label for="star3" title="3 étoiles"></label>
                <input type="radio" id="star2" name="Note" value="2" /><label for="star2" title="2 étoiles"></label>
                <input type="radio" id="star1" name="Note" value="1" /><label for="star1" title="1 étoile"></label>
            </div>

            <label for="Avis">Votre Commentaire :</label>
            <textarea id="Avis" name="Avis" required></textarea>

            <button type="submit" id="submit-button">Envoyer mon Avis</button>
            <div id="response-message" style="display:none;"></div>
        </form>
    </div>
    
    <script>
        document.getElementById('avisForm').addEventListener('submit', submitForm);

        function submitForm(e) {
            e.preventDefault();
            const form = e.target;
            const submitButton = document.getElementById('submit-button');
            const responseMessage = document.getElementById('response-message');
            
            // L'URL de votre Application Web (Apps Script)
            const googleSheetUrl = 'https://script.google.com/macros/s/AKfycbyj203cWTlHOhsWWeOLVB3zCg_16oTjcrwuMwxRh-HujuPGSUJhCTev_NhnPOPTjg-QfQ/exec'; 

            const data = new FormData(form);
            const dataObject = {};
            data.forEach((value, key) => { dataObject[key] = value; });

            submitButton.disabled = true;
            submitButton.textContent = "Envoi en cours...";
            responseMessage.style.display = 'none';

            fetch(googleSheetUrl, {
                method: 'POST',
                mode: 'no-cors', // Nécessaire pour les requêtes Apps Script
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams(dataObject)
            })
            .then(response => {
                // Succès supposé en raison de 'no-cors'. L'avis a été envoyé.
                responseMessage.style.backgroundColor = '#1e7e34';
                responseMessage.textContent = 'Merci ! Votre avis a été envoyé avec succès. Il sera visible sur la page des avis après validation.';
                responseMessage.style.display = 'block';
                form.reset(); // Vider le formulaire
                // Réactiver le bouton après un court délai
                setTimeout(() => {
                    submitButton.disabled = false;
                    submitButton.textContent = "Envoyer mon Avis";
                }, 2000);
            })
            .catch(error => {
                responseMessage.style.backgroundColor = '#dc3545';
                responseMessage.textContent = 'Une erreur est survenue lors de l\'envoi. Veuillez réessayer ou utiliser un autre moyen de contact.';
                responseMessage.style.display = 'block';
                submitButton.disabled = false;
                submitButton.textContent = "Envoyer mon Avis";
                console.error('Erreur:', error);
            });
        }
    </script>
</body>
</html>
